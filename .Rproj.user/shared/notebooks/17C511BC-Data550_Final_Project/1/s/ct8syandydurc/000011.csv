"0",""
"0",""
"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(gridExtra)"
"0","library(grid)"
"0","library(here)"
"0",""
"0",""
"0","charges_by_region <- final_data %>%"
"0","  group_by(region) %>%"
"0","  summarise("
"0","    mean_charges = mean(charges, na.rm = TRUE),"
"0","    median_charges = median(charges, na.rm = TRUE),"
"0","    sd_charges = sd(charges, na.rm = TRUE),"
"0","    min_charges = min(charges, na.rm = TRUE),"
"0","    max_charges = max(charges, na.rm = TRUE),"
"0","    n = n()"
"0","  ) %>%"
"0","  arrange(desc(mean_charges))"
"0",""
"0",""
"0","charges_by_region <- charges_by_region %>%"
"0","  mutate(across(where(is.numeric), round, 2))"
"0",""
"0",""
"0","table_plot <- tableGrob("
"0","  charges_by_region,"
"0","  rows = NULL,"
"0","  theme = ttheme_default("
"0","    core = list(fg_params = list(cex = 0.8)),"
"0","    colhead = list(fg_params = list(cex = 0.9, fontface = ""bold"", col = ""white""),"
"0","                   bg_params = list(fill = ""#4B9CD3"", col = NA))"
"0","  )"
"0",")"
"0",""
"0",""
"0","title <- textGrob("
"0","  ""Summary of Insurance Charges by Region"","
"0","  gp = gpar(fontsize = 14, fontface = ""bold"")"
"0",")"
"0",""
"0",""
"0","table_final <- gridExtra::grid.arrange(title, table_plot, nrow = 2, heights = c(0.2, 1))"
