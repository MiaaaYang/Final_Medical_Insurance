scale_y_continuous(labels = scales::dollar_format())
ggsave(
filename = here::here("output", "boxplot_reg.png"),
plot = boxplot_reg,
width = 8,      # width in inches
height = 6,     # height in inches
dpi = 300,      # image resolution
device = "png"
)
boxplot_reg
#visuliazation 2:
scatter <- ggplot(final_data, aes(x = bmi, y = charges, color = smoker)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE) +
labs(
title = "BMI and Insurance Charges by Smoking Status",
x = "Body Mass Index (BMI)",
y = "Insurance Charges ($)",
color = "Smoker"
) +
theme_minimal()
ggsave(
filename = here::here("output", "scatter.png"),
plot = scatter,
width = 8,      # width in inches
height = 6,     # height in inches
dpi = 300,      # image resolution
device = "png"
)
scatter
file.rename(
"code/Data550_Final_Project.pdf",
"Data550_Final_Project.pdf"
)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)
library(here)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges))
charges_by_region <- charges_by_region %>%
mutate(across(where(is.numeric), round, 2))
table_plot <- tableGrob(
charges_by_region,
rows = NULL,
theme = ttheme_default(
core = list(fg_params = list(cex = 0.8)),
colhead = list(fg_params = list(cex = 0.9, fontface = "bold", col = "white"),
bg_params = list(fill = "#4B9CD3", col = NA))
)
)
#  "Summary of Insurance Charges by Region",
#gp = gpar(fontsize = 14, fontface = "bold")
#)
table_final <- gridExtra::grid.arrange(title, table_plot, nrow = 2, heights = c(0.2, 1))
ggsave(
filename = here::here("output", "charges_by_region.png"),
plot = table_final,
width = 8,
height = 4,
dpi = 300
)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)
library(here)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges))
charges_by_region <- charges_by_region %>%
mutate(across(where(is.numeric), round, 2))
table_plot <- tableGrob(
charges_by_region,
rows = NULL,
theme = ttheme_default(
core = list(fg_params = list(cex = 0.8)),
colhead = list(fg_params = list(cex = 0.9, fontface = "bold", col = "white"),
bg_params = list(fill = "#4B9CD3", col = NA))
)
)
#  "Summary of Insurance Charges by Region",
#gp = gpar(fontsize = 14, fontface = "bold")
#)
table_final <- gridExtra::grid.arrange(title, table_plot, nrow = 2, heights = c(0.2, 1))
ggsave(
filename = here::here("output", "charges_by_region.png"),
plot = table_final,
width = 8,
height = 4,
dpi = 300
)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)
library(here)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges))
charges_by_region <- charges_by_region %>%
mutate(across(where(is.numeric), round, 2))
table_plot <- tableGrob(
charges_by_region,
rows = NULL,
theme = ttheme_default(
core = list(fg_params = list(cex = 0.8)),
colhead = list(fg_params = list(cex = 0.9, fontface = "bold", col = "white"),
bg_params = list(fill = "#4B9CD3", col = NA))
)
)
#  "Summary of Insurance Charges by Region",
#gp = gpar(fontsize = 14, fontface = "bold")
#)
#table_final <- gridExtra::grid.arrange(title, table_plot, nrow = 2, heights = c(0.2, 1))
ggsave(
filename = here::here("output", "charges_by_region.png"),
plot = table_final,
width = 8,
height = 4,
dpi = 300
)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)
library(here)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges))
charges_by_region <- charges_by_region %>%
mutate(across(where(is.numeric), round, 2))
table_plot <- tableGrob(
charges_by_region,
rows = NULL,
theme = ttheme_default(
core = list(fg_params = list(cex = 0.8)),
colhead = list(fg_params = list(cex = 0.9, fontface = "bold", col = "white"),
bg_params = list(fill = "#4B9CD3", col = NA))
)
)
#  "Summary of Insurance Charges by Region",
#gp = gpar(fontsize = 14, fontface = "bold")
#)
table_final <- gridExtra::grid.arrange(title, table_plot, nrow = 2, heights = c(0.2, 1))
ggsave(
filename = here::here("output", "charges_by_region.png"),
plot = table_final,
width = 8,
height = 4,
dpi = 300
)
library(dplyr)
library(knitr)
library(kableExtra)
library(here)
# Summarize insurance charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), ~ round(.x, 2)))
# Create a clean formatted table
table_final <- charges_by_region %>%
kbl(caption = "Summary of Insurance Charges by Region",
align = "c") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),
full_width = FALSE,
position = "center") %>%
row_spec(0, bold = TRUE, color = "white", background = "#49BCD3")
# Save the table as an image
save_kable(
table_final,
file = here("output", "charges_by_region.png"),
zoom = 2
)
install.packages("magick")
library(dplyr)
# Summarize charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), ~ round(.x, 2)))
# Save a simple PNG table
png("charges_by_region.png", width = 900, height = 500)
plot.new()
title("Summary of Insurance Charges by Region", line = -1)
grid::grid.table(charges_by_region)
library(dplyr)
# Summarize insurance charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), ~ round(.x, 2)))
# Save a simple PNG table in output folder
png("output/charges_by_region.png", width = 900, height = 500)
plot.new()
title(main = "Summary of Insurance Charges by Region", line = -1)
text(0, 0.9, paste(capture.output(print(charges_by_region)), collapse = "\n"), adj = 0)
dev.off()
library(dplyr)
# Summarize insurance charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), ~ round(.x, 2)))
# Save a simple PNG table in output folder
png("output/charges_by_region.png", width = 900, height = 500)
plot.new()
title(main = "Summary of Insurance Charges by Region", line = -1)
text(0, 0.9, paste(capture.output(print(charges_by_region)), collapse = "\n"), adj = 0)
library(dplyr)
# Summarize insurance charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), ~ round(.x, 2)))
# Save a simple PNG table in output folder
png("output/charges_by_region_1.png", width = 900, height = 500)
plot.new()
title(main = "Summary of Insurance Charges by Region", line = -1)
text(0, 0.9, paste(capture.output(print(charges_by_region)), collapse = "\n"), adj = 0)
dev.off()
library(dplyr)
# Step 1: Create the folder if it doesn't exist
if (!dir.exists("output")) dir.create("output")
# Step 2: Summarize and save as PNG
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges = mean(charges, na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges = sd(charges, na.rm = TRUE),
min_charges = min(charges, na.rm = TRUE),
max_charges = max(charges, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
png("output/charges_by_region.png", width = 900, height = 500)
plot.new()
title(main = "Summary of Insurance Charges by Region", line = -1)
text(0, 0.9, paste(capture.output(charges_by_region), collapse = "\n"), adj = 0)
dev.off()
library(dplyr)
# Ensure output folder exists
if (!dir.exists("output")) dir.create("output")
# Summarize insurance charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
# Save a nice PNG table
png("output/charges_by_region.png", width = 1000, height = 600)
par(mar = c(2, 1, 4, 1))  # margins: bottom, left, top, right
plot.new()
title(main = "Summary of Insurance Charges by Region", col.main = "#2E86C1", font.main = 2, cex.main = 1.5)
# Convert to character matrix for pretty spacing
tbl_text <- capture.output(print(charges_by_region, row.names = FALSE))
text(
x = 0.5, y = 0.8,
paste(tbl_text, collapse = "\n"),
adj = c(0.5, 1),  # centered
family = "mono",  # fixed-width font
cex = 0.9         # text size
)
dev.off()
library(dplyr)
library(knitr)
# Summarize charges by region
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
# Display a clean, knit-friendly table
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
cat("**Table 2: Summary of Insurance Charges by Region**\n\n")
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
png("output/charges_by_region.png", width = 900, height = 400)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
png("output/charges_by_region_1.png", width = 900, height = 400)
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(
charges_by_region,
caption = "Summary of Insurance Charges by Region",
align = "c",
digits = 2
)
if (!dir.exists("output")) dir.create("output")
png("output/charges_by_region.png", width = 900, height = 400)
gridExtra::grid.table(charges_by_region)
dev.off()
library(dplyr)
library(knitr)
charges_by_region <- final_data %>%
group_by(region) %>%
summarise(
mean_charges   = mean(charges,  na.rm = TRUE),
median_charges = median(charges, na.rm = TRUE),
sd_charges     = sd(charges,    na.rm = TRUE),
min_charges    = min(charges,   na.rm = TRUE),
max_charges    = max(charges,   na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_charges)) %>%
mutate(across(where(is.numeric), round, 2))
kable(charges_by_region, align = "c", digits = 2)
